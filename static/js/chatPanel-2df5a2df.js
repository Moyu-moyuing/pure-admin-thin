import{d as O,n as l,ar as d,p as N,t as G,r as _,o as c,i as p,j as k,b as s,a as f,g as y,c as q,v as P,F as R,T as K,z as x,h as A,K as J,ah as Q,ai as W,_ as X}from"./index-92e539ba.js";import ee from"./sessionItem-5d346c6f.js";import se from"./message-be41f474.js";import te from"./chatInput-a3e835df.js";import{R as ae}from"./refresh-74425c09.js";import"./close-7f9c3d31.js";import"./textLoading-c0eb11f8.js";import"./user-3be56ec8.js";const oe={width:1024,height:1024,body:'<path fill="currentColor" d="M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8Z"/><path fill="currentColor" d="M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8Z"/>'},le=oe,ne={width:24,height:24,body:'<path fill="currentColor" d="M6 5h12a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Z"/>'},ie=ne,T=h=>(Q("data-v-b0d25475"),h=h(),W(),h),re={class:"flex bg-[var(--el-bg-color)]"},ce={class:"bg-[rgb(32,33,35)] w-[250px] text-white dark:text-white rounded-tl-[var(--el-card-border-radius)] rounded-bl-[var(--el-card-border-radius)] relative border-r-[1px] border-solid border-white/20 p-2"},de=T(()=>s("div",{class:"mt-[20px] text-[20px]"},"江湖百晓生",-1)),me=T(()=>s("div",{class:"text-[10px] mt-[10px]"},"介绍信息...",-1)),ue={class:"mt-5 mb-5 flex flex-row gap-2"},ve=T(()=>s("span",null,"新建会话",-1)),pe={class:"w-full h-[800px] relative"},fe={class:"pt-5 text-center"},he={class:"text-[rgba(black,0.7)] text-xl"},ge={class:"text-[rgba(black,0.5)]"},_e={class:"text-[rgba(black,0.5)] mb-3"},xe={class:"absolute bottom-0 left-0 w-full border-t md:border-t-0 dark:border-white/20 md:border-transparent md:dark:border-transparent bg-inherit md:!bg-transparent md:pl-2 md:w-[calc(100%)-0.5rem]"},be={class:"mx-2 flex flex-row gap-3 last:mb-2 md:mx-4 md:last:mb-6 lg:mx-auto lg:max-w-2xl xl:max-w-3xl"},we={class:"relative flex h-full flex-1 items-stretch md:flex-col"},ke={class:"h-full flex ml-1 md:w-full md:m-auto md:mb-4 gap-0 md:gap-2 justify-center"},ye=O({name:"ChatPanel"}),Te=O({...ye,setup(h){const M=l({}),m=l(null),S=l(null),Y=l(null),V=[{id:0,title:"新的聊天",time:"2023-08-28 12:00:00",sessionNum:2,message:[{content:"你好！",role:"user",createTime:d().format("YYYY-MM-DD HH:mm:ss")},{content:"你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！你好！",role:"assistant",createTime:d().format("YYYY-MM-DD HH:mm:ss")}]},{id:1,title:"新的聊天",time:"2023-08-28 12:00:00",sessionNum:0,message:[]},{id:2,title:"新的聊天",time:"2023-08-28 12:00:00",sessionNum:0,message:[]},{id:3,title:"新的聊天",time:"2023-08-28 12:00:00",sessionNum:0,message:[]},{id:4,title:"新的聊天",time:"2023-08-28 12:00:00",sessionNum:0,message:[]}],t=l({message:[]}),n=l([]),B=()=>{n.value.push(...V),n.value.length>0&&(t.value=I.value[0])},L=e=>{var a;t.value=e,(a=Y.value)==null||a.clearInput()},j=e=>{const a=n.value.findIndex(i=>i.id===e.id);n.value.splice(a,1)},$=()=>{const e={id:n.value.length+1,title:"新的聊天",time:"2023-08-28",sessionNum:0,message:[]};n.value.unshift(e),t.value=e},Z=(e,a)=>{e.title=a},F=e=>{M.value={role:"assistant",content:e,createTime:d().format("YYYY-MM-DD HH:mm:ss")};const a={session:Object.assign({},t.value),content:e,role:"user",createTime:d().format("YYYY-MM-DD HH:mm:ss")};a.session.message=[],t.value.message.push(a,M.value),t.value.sessionNum+=2,b.value=!0,J(C)},g=l(!1),b=l(!1),U=e=>{g.value=e,b.value=e},z=N(()=>g.value?"停止响应":"重新生成"),C=()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)},E=e=>{var a;(a=S.value[e])==null||a.toggleTyping()},I=N(()=>{const e=n.value;return e.length===0?e:e.slice().sort((i,w)=>{var D,H;const u=i.message,v=w.message;if(!u||!v)return 0;const o=(D=u[u.length-1])==null?void 0:D.createTime,r=(H=v[v.length-1])==null?void 0:H.createTime;return o===void 0||r===void 0?0:d(r).valueOf()-d(o).valueOf()})});return G(()=>{B(),C()}),(e,a)=>{const i=_("IconifyIconOffline"),w=_("el-divider"),u=_("el-button"),v=_("el-card");return c(),p(v,{class:"w-full flex"},{default:k(()=>[s("div",re,[s("div",ce,[de,me,s("div",ue,[s("span",{class:"flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 text-white cursor-pointer text-sm rounded-md border border-white/20 hover:bg-gray-500/10 h-11 flex-grow overflow-hidden",onClick:$},[f(i,{icon:y(le)},null,8,["icon"]),ve])]),f(K,{name:"list-fade",tag:"div"},{default:k(()=>[(c(!0),q(R,null,P(I.value,o=>(c(),p(ee,{key:o.id,active:o.id===t.value.id,session:o,onClick:r=>L(o),onDelete:r=>j(o),onUpdateTitle:Z},null,8,["active","session","onClick","onDelete"]))),128))]),_:1})]),s("div",pe,[s("div",fe,[s("div",he,x(t.value.title),1),s("div",ge," 与江湖百晓生的"+x(t.value.sessionNum)+"条对话 ",1),s("div",_e,x(t.value.message.length===0?"创建于"+t.value.time:"最近更改于"+t.value.message[t.value.message.length-1].createTime),1)]),f(w),s("div",{class:"overflow-y-auto h-[65%]",ref_key:"messagePanelRef",ref:m},[(c(!0),q(R,null,P(t.value.message,(o,r)=>(c(),p(se,{ref_for:!0,ref_key:"messageModel",ref:S,key:o.createTime+r,message:o,isTyping:r===t.value.message.length-1&&b.value,messagePanelRef:m.value,onRespond:U},null,8,["message","isTyping","messagePanelRef"]))),128))],512),s("div",xe,[s("form",be,[s("div",we,[s("div",ke,[f(u,{onClick:a[0]||(a[0]=o=>E(t.value.message.length-1))},{default:k(()=>[g.value?(c(),p(i,{key:1,icon:y(ie),class:"mr-2"},null,8,["icon"])):(c(),p(i,{key:0,icon:y(ae),class:"mr-2"},null,8,["icon"])),A(" "+x(z.value),1)]),_:1})]),f(te,{onSend:F,respond:g.value,ref_key:"chatInputModel",ref:Y},null,8,["respond"])])])])])])]),_:1})}}});const qe=X(Te,[["__scopeId","data-v-b0d25475"]]);export{qe as default};
